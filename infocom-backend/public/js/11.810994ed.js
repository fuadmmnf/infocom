(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{6635:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{staticClass:" q-ma-md"},[e.$store.getters.hasAdminAccess?a("div",{staticClass:"row justify-end"},[a("q-btn",{attrs:{label:"Create"},on:{click:function(t){e.showResourceForm=!0}}},[a("q-dialog",{attrs:{persistent:""},model:{value:e.showResourceForm,callback:function(t){e.showResourceForm=t},expression:"showResourceForm"}},[a("q-card",{staticStyle:{"min-width":"350px"}},[a("q-card-section",{staticClass:"q-pa-xs"},[a("q-list",{attrs:{bordered:"",padding:""}},[a("q-item-label",{attrs:{header:""}},[e._v("Create New Resource")]),a("q-item",[a("q-item-section",[a("q-select",{attrs:{filled:"",options:e.resourceOptions,label:"Type","emit-value":"",rules:[function(e){return!!e||"Select resource type"}]},model:{value:e.resourceForm.type,callback:function(t){e.$set(e.resourceForm,"type",t)},expression:"resourceForm.type"}}),a("q-input",{attrs:{filled:"",label:"Name",rules:[function(e){return!!e||"Enter resource name"}]},model:{value:e.resourceForm.name,callback:function(t){e.$set(e.resourceForm,"name",t)},expression:"resourceForm.name"}}),"slaplans"===e.resourceForm.type?a("q-input",{attrs:{filled:"",label:"Time",rules:[function(e){return!!e||"Enter time limit"}]},model:{value:e.resourceForm.timelimit,callback:function(t){e.$set(e.resourceForm,"timelimit",e._n(t))},expression:"resourceForm.timelimit"}}):e._e()],1)],1)],1)],1),a("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Close"}}),a("q-btn",{attrs:{flat:"",disable:""===e.resourceForm.type||""===e.resourceForm.name,label:"Confirm"},on:{click:e.createResource}})],1)],1)],1)],1)],1):e._e(),a("br"),a("div",{staticClass:"row"},[a("resource-table",{staticClass:"q-px-md",attrs:{title:"Help Topics",resource_url:"helptopics"}}),a("resource-table",{staticClass:"q-px-md",attrs:{title:"SLA Plans",resource_url:"slaplans"}}),a("resource-table",{staticClass:"q-px-md",attrs:{title:"Pop Addresses",resource_url:"popaddresses"}}),a("resource-table",{staticClass:"q-px-md",attrs:{title:"Departments",resource_url:"departments"}})],1)])},s=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-table",{attrs:{title:e.title,data:e.data,columns:e.columns,"row-key":"id","rows-per-page-options":[0],pagination:e.pagination,"hide-bottom":""},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"top-right",fn:function(){return[e.supportagents.length?a("q-btn",{attrs:{"no-caps":"",label:"Assign Leader"},on:{click:function(t){e.showLeaderAssignForm=!0}}},[a("q-dialog",{attrs:{persistent:""},model:{value:e.showLeaderAssignForm,callback:function(t){e.showLeaderAssignForm=t},expression:"showLeaderAssignForm"}},[a("q-card",{staticStyle:{"min-width":"350px"}},[a("q-form",{on:{submit:e.createDepartmentLeader}},[a("q-card-section",{staticClass:"q-pa-xs"},[a("q-list",{attrs:{bordered:"",padding:""}},[a("q-item-label",{attrs:{header:""}},[e._v("Assign Department Leader\n                  ")]),a("q-item",[a("q-item-section",[a("q-select",{staticClass:"q-mb-md",attrs:{filled:"",options:e.data,"option-label":"name","option-value":"id","emit-value":"","map-options":"",label:"Department"},model:{value:e.departmentLeaderForm.department_id,callback:function(t){e.$set(e.departmentLeaderForm,"department_id",e._n(t))},expression:"departmentLeaderForm.department_id"}}),a("q-select",{staticClass:"q-mb-md",attrs:{filled:"",options:e.supportagents.filter((function(t){return t.department_id===e.departmentLeaderForm.department_id})),"option-label":function(e){return void 0!==e.user?e.user.name+" ("+e.user.phone+")":""},"option-value":"id","emit-value":"","map-options":"",label:"Team Leader"},model:{value:e.departmentLeaderForm.leader_id,callback:function(t){e.$set(e.departmentLeaderForm,"leader_id",e._n(t))},expression:"departmentLeaderForm.leader_id"}})],1)],1)],1)],1),a("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Close"}}),a("q-btn",{attrs:{flat:"",disable:""===e.departmentLeaderForm.department_id||""===e.departmentLeaderForm.leader_id,label:"Confirm",type:"submit"}})],1)],1)],1)],1)],1):e._e()]},proxy:!0}])})],1)},i=[],n=(a("5319"),{name:"ResourceTable",props:{title:{type:String,required:!0},resource_url:{type:String,required:!0}},data(){return{showLeaderAssignForm:!1,pagination:{page:1,rowsPerPage:0},data:[],columns:[{name:"name",align:"center",label:"Name",field:"name",sortable:!0}],supportagents:[],departmentLeaderForm:{department_id:"",leader_id:""}}},mounted(){"departments"===this.resource_url?(this.fetchSupportAgents(),this.columns.push({name:"leader",align:"center",label:"Leader",field:e=>null!==e.leader?`${e.leader.user.name} (${e.leader.user.phone})`:""})):"slaplans"===this.resource_url&&this.columns.push({name:"timelimits",align:"center",label:"Limit",field:e=>null!==e.timelimit?`${e.timelimit} hours`:""}),this.fetchResource(),this.$root.$on("resource-created",this.fetchResource)},methods:{fetchResource(){this.$axios.get(this.resource_url).then((e=>{this.data=e.data,this.$store.commit("set"+this.title.replace(" ",""),this.data)}))},fetchSupportAgents(){this.$axios.get("supportagents").then((e=>{this.supportagents=e.data}))},createDepartmentLeader(){this.$axios.put(`departments/${this.departmentLeaderForm.department_id}`,this.departmentLeaderForm).then((e=>{this.showLeaderAssignForm=!1,this.departmentLeaderForm={department_id:"",leader_id:""},this.$q.notify({type:"positive",message:"Department Leader Assigned",position:"top-right"}),this.fetchResource()}))}}}),l=n,c=a("2877"),m=a("eaac"),d=a("9c40"),p=a("24e8"),u=a("f09f"),h=a("0378"),b=a("a370"),f=a("1c1c"),g=a("0170"),q=a("66e5"),F=a("4074"),_=a("ddd8"),v=a("4b7e"),L=a("7f67"),w=a("eebe"),C=a.n(w),y=Object(c["a"])(l,o,i,!1,null,"f14028d2",null),x=y.exports;C()(y,"components",{QTable:m["a"],QBtn:d["a"],QDialog:p["a"],QCard:u["a"],QForm:h["a"],QCardSection:b["a"],QList:f["a"],QItemLabel:g["a"],QItem:q["a"],QItemSection:F["a"],QSelect:_["a"],QCardActions:v["a"]}),C()(y,"directives",{ClosePopup:L["a"]});var Q={name:"DashboardResources",components:{ResourceTable:x},data(){return{showResourceForm:!1,resourceOptions:[{label:"Help Topic",value:"helptopics"},{label:"Pop Address",value:"popaddresses"},{label:"Department",value:"departments"},{label:"SLA Plan",value:"slaplans"}],resourceForm:{type:"",name:"",timelimit:""}}},methods:{createResource(){this.$axios.post(this.resourceForm.type,this.resourceForm).then((e=>{201===e.status&&(this.showResourceForm=!1,this.resourceForm={},this.$root.$emit("resource-created"),this.$q.notify({type:"positive",message:"Resource Created Successfully",position:"top-right"}))}))}}},$=Q,A=a("9989"),R=a("27f9"),S=Object(c["a"])($,r,s,!1,null,null,null);t["default"]=S.exports;C()(S,"components",{QPage:A["a"],QBtn:d["a"],QDialog:p["a"],QCard:u["a"],QCardSection:b["a"],QList:f["a"],QItemLabel:g["a"],QItem:q["a"],QItemSection:F["a"],QSelect:_["a"],QInput:R["a"],QCardActions:v["a"]}),C()(S,"directives",{ClosePopup:L["a"]})}}]);