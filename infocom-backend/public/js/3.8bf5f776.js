(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{6606:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-form",{staticClass:"q-gutter-md",on:{submit:function(e){void 0===t.complain.status?t.createComplain():t.updateComplain(!0)},reset:function(e){t.complain={}}}},[t.isAuthenticated&&void 0===t.complain.status?a("div",{staticClass:"row items-center"},[a("q-input",{staticClass:"col-md-3 col-xs-5  q-my-xs q-px-xs",attrs:{filled:"",label:"Search Customer"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),a("q-btn",{attrs:{flat:"",label:"search",type:"button"},on:{click:t.searchCustomer}})],1):t._e(),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col-md-6 col-xs-12  q-my-xs q-px-xs",attrs:{filled:"",label:"Full Name",disable:t.statusIndex>0,readonly:t.isAuthenticated},model:{value:t.complain.name,callback:function(e){t.$set(t.complain,"name",e)},expression:"complain.name"}}),a("q-input",{staticClass:"col-md-6 col-xs-12  q-my-xs q-px-xs",attrs:{filled:"",label:"Phone",disable:t.statusIndex>0,readonly:t.isAuthenticated},model:{value:t.complain.phone,callback:function(e){t.$set(t.complain,"phone",e)},expression:"complain.phone"}})],1),a("div",{staticClass:"row q-my-none"},[a("q-input",{staticClass:"col-md-6 col-xs-12 q-my-xs q-px-xs",attrs:{filled:"",type:"email",label:"Email",disable:t.statusIndex>0,readonly:t.isAuthenticated},model:{value:t.complain.email,callback:function(e){t.$set(t.complain,"email",e)},expression:"complain.email"}}),a("q-select",{staticClass:"col-md-6 col-xs-12 q-my-xs q-px-xs",attrs:{filled:"",options:t.$store.getters.getHelpTopics,"option-label":"name","option-value":"id","emit-value":"","map-options":"",label:"Help Topic",disable:t.statusIndex>0},model:{value:t.complain.helptopic_id,callback:function(e){t.$set(t.complain,"helptopic_id",t._n(e))},expression:"complain.helptopic_id"}})],1),t.$store.getters.getDepartments.length?a("div",{staticClass:"row q-my-none"},[a("q-select",{staticClass:"col-md-6 col-xs-12 q-my-xs q-px-xs",attrs:{filled:"",options:[{label:"Agent Create",value:"agent"},{label:"Customer Email",value:"email"}],"emit-value":"",label:"Ticket Source",disable:t.statusIndex>0},model:{value:t.complain.ticket_source,callback:function(e){t.$set(t.complain,"ticket_source",e)},expression:"complain.ticket_source"}}),a("q-select",{staticClass:"col-md-6 col-xs-12 q-my-xs q-px-xs",attrs:{filled:"",options:t.$store.getters.getDepartments,"option-label":"name","option-value":"id","emit-value":"","map-options":"",label:"Department",disable:t.statusIndex>0},model:{value:t.complain.department_id,callback:function(e){t.$set(t.complain,"department_id",t._n(e))},expression:"complain.department_id"}})],1):t._e(),t.$store.getters.getSLAPlans.length?a("div",{staticClass:"row q-my-none"},[a("q-select",{staticClass:"col-md-6 col-xs-12 q-my-xs q-px-xs",attrs:{filled:"",options:t.$store.getters.getSLAPlans,"option-label":"name","option-value":"id","emit-value":"","map-options":"",label:"SLA Plan",disable:t.statusIndex>0},model:{value:t.complain.slaplan_id,callback:function(e){t.$set(t.complain,"slaplan_id",t._n(e))},expression:"complain.slaplan_id"}}),a("q-select",{staticClass:"col-md-6 col-xs-12 q-my-xs q-px-xs",attrs:{filled:"",options:[{label:"Low",value:"low"},{label:"Medium",value:"medium"},{label:"High",value:"high"},{label:"Urgent",value:"urgent"}],"emit-value":"",label:"Priority",disable:t.statusIndex>0},model:{value:t.complain.priority,callback:function(e){t.$set(t.complain,"priority",e)},expression:"complain.priority"}})],1):t._e(),t.$store.getters.getDepartments.length?a("q-input",{staticClass:" q-my-xs q-px-xs",attrs:{filled:"",type:"textarea",autogrow:"",label:"Complain Summary",disable:t.statusIndex>0},model:{value:t.complain.complain_summary,callback:function(e){t.$set(t.complain,"complain_summary",e)},expression:"complain.complain_summary"}}):t._e(),a("q-input",{staticClass:" q-my-xs q-px-xs",attrs:{filled:"",type:"textarea",autogrow:"",label:"Complain details",disable:t.statusIndex>0},model:{value:t.complain.complain_text,callback:function(e){t.$set(t.complain,"complain_text",e)},expression:"complain.complain_text"}}),t.statusIndex>1?a("q-input",{staticClass:" q-my-xs q-px-xs",attrs:{filled:"",type:"textarea",autogrow:"",label:"Complain Feedback",disable:t.statusIndex>3||!t.isComplainEditor},model:{value:t.complain.complain_feedback,callback:function(e){t.$set(t.complain,"complain_feedback",e)},expression:"complain.complain_feedback"}}):t._e(),void 0===t.complain.status?a("div",[a("q-btn",{staticClass:" q-mr-sm",attrs:{label:"Reset",type:"reset"}}),a("q-btn",{staticClass:"bg-purple text-white",attrs:{label:"Submit",type:"submit",disable:t.$store.getters.getActionRunningState}})],1):0===t.statusIndex?a("div",[a("q-btn",{staticClass:"bg-info text-white q-mr-sm",attrs:{label:"Save",type:"button",disable:t.$store.getters.getActionRunningState},on:{click:function(e){return t.updateComplain(!1)}}}),a("q-btn",{staticClass:"bg-purple text-white",attrs:{label:"Submit",type:"submit",disable:t.$store.getters.getActionRunningState}})],1):1===t.statusIndex&&void 0!==t.$store.getters.getUser.support_agent?a("div",[a("q-select",{staticClass:"col-md-6 col-xs-8 q-my-xs q-px-xs",attrs:{filled:"",options:t.supportagents.filter((function(e){return e.department_id===t.complain.department_id})),"option-label":function(t){return void 0===t.user?"":t.user.name+" ("+t.user.phone+")"},"option-value":"id","emit-value":"","map-options":"",label:"Editor",disable:t.statusIndex>1||!t.hasTeamLeaderPermission},model:{value:t.complain.editor_id,callback:function(e){t.$set(t.complain,"editor_id",t._n(e))},expression:"complain.editor_id"}}),a("q-btn",{staticClass:"bg-purple text-white",attrs:{"no-caps":"",label:"Confirm Ticket",type:"submit",disable:t.$store.getters.getActionRunningState}})],1):2===t.statusIndex?a("div",[a("q-select",{staticClass:"col-md-6 col-xs-8 q-my-xs q-px-xs",attrs:{filled:"",options:t.supportagents.filter((function(e){return e.department_id===t.complain.department_id})),"option-label":function(t){return void 0===t.user?"":t.user.name+" ("+t.user.phone+")"},"option-value":"id","emit-value":"","map-options":"",label:"Editor",disable:t.statusIndex>1||!t.hasTeamLeaderPermission},model:{value:t.complain.editor_id,callback:function(e){t.$set(t.complain,"editor_id",t._n(e))},expression:"complain.editor_id"}}),a("q-btn",{staticClass:"bg-info text-white q-mr-sm",attrs:{label:"Save",type:"button",disable:t.$store.getters.getActionRunningState},on:{click:function(e){return t.updateComplain(!1)}}}),a("q-btn",{staticClass:"bg-purple text-white",attrs:{label:"Submit",type:"submit",disable:t.$store.getters.getActionRunningState}})],1):3===t.statusIndex?a("div",[a("q-btn",{staticClass:"bg-purple text-white",attrs:{label:"Approve",type:"submit",disable:t.$store.getters.getActionRunningState}})],1):t._e()],1)},i=[],n=a("ded3"),l=a.n(n),o={name:"ComplainForm",props:{existingComplain:{type:Object,default:()=>({})},supportagents:{type:Array,default:()=>[]}},data(){return{statusList:["pending","assigned","working","finished","approved"],search:"",complain:{name:"",phone:"",email:"",helptopic_id:"",complain_text:""}}},computed:{statusIndex:function(){return this.statusList.indexOf(this.complain.status)},isAuthenticated:function(){return null!==this.$store.getters.getUser&&void 0!==this.$store.getters.getUser.phone},isComplainEditor:function(){return(null===this.$store.getters.getUser||void 0!==this.$store.getters.getUser.support_agent)&&this.complain.editor_id===this.$store.getters.getUser.support_agent.id},hasTeamLeaderPermission:function(){return(null===this.$store.getters.getUser||void 0!==this.$store.getters.getUser.support_agent)&&this.$store.getters.getDepartments.find((t=>t.leader_id===this.$store.getters.getUser.support_agent.id&&t.id===this.complain.department_id))}},mounted(){void 0!==this.existingComplain.status&&(this.complain=l()(l()({},this.existingComplain),{},{name:this.existingComplain.customer.user.name,phone:this.existingComplain.customer.user.phone,email:this.existingComplain.customer.user.email})),null!==this.$store.getters.getUser&&void 0!==this.$store.getters.getUser.support_agent&&(this.complain.editor_id=this.$store.getters.getUser.support_agent.id)},methods:{searchCustomer(){this.$axios.get(`customers/${this.search}`).then((t=>{this.complain.customer_id=t.data.id,this.complain.name=t.data.user.name,this.complain.email=t.data.user.email,this.complain.phone=t.data.user.phone}))},createComplain(){this.isAuthenticated&&void 0!==this.$store.getters.getUser.callcenter_agent&&(this.complain.agent_id=this.$store.getters.getUser.callcenter_agent.id),this.$axios.post("complains",this.complain).then((t=>{201===t.status&&(this.complain={},this.$root.$emit("complain-created",t.data))}))},updateComplain(t){t&&(this.complain.status=this.statusList[this.statusList.indexOf(this.complain.status)+1],"assigned"===this.complain.status&&(this.complain.agent_id=this.isAuthenticated&&void 0!==this.$store.getters.getUser.callcenter_agent?this.$store.getters.getUser.callcenter_agent.id:null)),this.$axios.put(`complains/${this.complain.id}`,this.complain).then((t=>{this.$root.$emit("complain-updated",t.data)})).catch((e=>{t&&(this.complain.status=this.statusList[this.statusList.indexOf(this.complain.status)-1])}))}}},r=o,p=a("2877"),c=a("0378"),m=a("27f9"),d=a("9c40"),u=a("ddd8"),g=a("eebe"),h=a.n(g),b=Object(p["a"])(r,s,i,!1,null,"5e591a89",null);e["a"]=b.exports;h()(b,"components",{QForm:c["a"],QInput:m["a"],QBtn:d["a"],QSelect:u["a"]})},"7ffc":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",[a("div",{staticClass:"q-gutter-y-md q-pa-sm"},[a("q-card",[a("q-tabs",{staticClass:"text-grey",attrs:{dense:"","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[t.hasCallcenterAgentAccess?a("q-tab",{attrs:{name:"agent-complain",label:"New Complain"}}):t._e(),t.hasCallcenterAgentAccess?a("q-tab",{attrs:{name:"pending",label:"Pending Complains"}}):t._e(),t.hasSupportAgentAccess?a("q-tab",{attrs:{name:"assigned",label:"Assigned Complains"}}):t._e(),t.hasSupportAgentAccess?a("q-tab",{attrs:{name:"running",label:"Running Complains"}}):t._e(),t.hasCallcenterAgentAccess?a("q-tab",{attrs:{name:"feedback",label:"Feedback Complains"}}):t._e(),a("q-tab",{attrs:{name:"history",label:"Complain History"}}),a("q-tab",{attrs:{name:"overdue",label:"Overdue Complains"}})],1),a("q-separator"),a("q-tab-panels",{attrs:{animated:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[t.hasCallcenterAgentAccess?a("q-tab-panel",{attrs:{name:"agent-complain"}},[a("div",{staticClass:"text-h6"},[t._v("New Customer Complain")]),a("complain-form")],1):t._e(),t.hasCallcenterAgentAccess?a("q-tab-panel",{attrs:{name:"pending"}},[a("div",{staticClass:"text-h6"},[t._v("Pending Complains")]),a("complains-list",{attrs:{status:"pending"}})],1):t._e(),t.hasSupportAgentAccess?a("q-tab-panel",{attrs:{name:"assigned"}},[a("div",{staticClass:"text-h6"},[t._v("Requested Complains")]),a("complains-list",{attrs:{status:"assigned"}})],1):t._e(),t.hasSupportAgentAccess?a("q-tab-panel",{attrs:{name:"running"}},[a("div",{staticClass:"text-h6"},[t._v("Running Complains")]),a("complains-list",{attrs:{status:"working"}})],1):t._e(),t.hasCallcenterAgentAccess?a("q-tab-panel",{attrs:{name:"feedback"}},[a("div",{staticClass:"text-h6"},[t._v("Feedback Complains")]),a("complains-list",{attrs:{status:"finished"}})],1):t._e(),a("q-tab-panel",{attrs:{name:"history"}},[a("div",{staticClass:"text-h6"},[t._v("Complain History")]),a("complains-list",{attrs:{status:"approved"}})],1),a("q-tab-panel",{attrs:{name:"overdue"}},[a("div",{staticClass:"text-h6"},[t._v("Overdue History")]),a("complains-list",{attrs:{status:"overdue"}})],1)],1)],1)],1)])},i=[],n=a("6606"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-table",{attrs:{title:"",flat:"",data:t.complains,columns:t.columns,"row-key":"id","rows-per-page-options":[20],pagination:t.pagination},on:{"update:pagination":[function(e){t.pagination=e},function(e){var a=e.page;t.fetchComplainsList(a)}],"row-click":function(e,a,s){t.selectedComplain=a,t.showComplainDetailModal=!0}}}),a("q-dialog",{attrs:{persistent:""},on:{hide:function(e){t.selectedComplain=null}},model:{value:t.showComplainDetailModal,callback:function(e){t.showComplainDetailModal=e},expression:"showComplainDetailModal"}},[a("q-card",{staticStyle:{"min-width":"70%"}},[a("q-bar",[a("div",[t._v("Complain Details")]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}},[a("q-tooltip",[t._v("Close")])],1)],1),a("q-card-section",{staticClass:"q-pa-xs"},[a("complain-form",{attrs:{"existing-complain":t.selectedComplain,supportagents:t.supportagents}})],1),a("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}})],1)],1)],1)},o=[],r=a("bd4c"),p={name:"ComplainsList",components:{ComplainForm:n["a"]},props:{status:{type:String,required:!0}},data(){return{showComplainDetailModal:!1,selectedComplain:null,selectedDepartmentId:void 0===this.$store.getters.getUser.support_agent?"":this.$store.getters.getUser.support_agent.department_id,supportagents:[],pagination:{page:1,rowsPerPage:20},complains:[],columns:[{name:"name",align:"center",label:"Name",field:t=>t.customer.user.name},{name:"phone",align:"center",label:"Phone",field:t=>t.customer.user.phone},{name:"email",align:"center",label:"Email",field:t=>t.customer.user.email},{name:"priority",align:"center",label:"Priority",field:t=>t.priority},{name:"complain_time",align:"center",label:"Time",field:t=>r["b"].formatDate(t.complain_time,"D MMM, YYYY hh:mm A")}]}},mounted(){"assigned"===this.status&&this.fetchSupportAgent(),this.fetchSupportAgent(),this.$root.$on("complain-updated",(t=>{this.showComplainDetailModal=!1,this.selectedComplain=null,this.fetchComplainsList(this.pagination.page),this.$q.notify({type:"positive",message:"Complain Submitted Successfully",position:"top-right"})}))},methods:{fetchComplainsList(t=1){this.$axios.get(`complains?status=${this.status}${""===this.selectedDepartmentId?"":"&department_id="+this.selectedDepartmentId}&page=${t}`).then((t=>{this.complains=t.data.data}))},fetchSupportAgent(){this.$axios.get("supportagents").then((t=>{this.supportagents=t.data}))}}},c=p,m=a("2877"),d=a("eaac"),u=a("24e8"),g=a("f09f"),h=a("d847"),b=a("2c91"),x=a("9c40"),C=a("05c0"),f=a("a370"),v=a("4b7e"),_=a("7f67"),q=a("eebe"),$=a.n(q),y=Object(m["a"])(c,l,o,!1,null,"bd86fb38",null),A=y.exports;$()(y,"components",{QTable:d["a"],QDialog:u["a"],QCard:g["a"],QBar:h["a"],QSpace:b["a"],QBtn:x["a"],QTooltip:C["a"],QCardSection:f["a"],QCardActions:v["a"]}),$()(y,"directives",{ClosePopup:_["a"]});var w={name:"DashboardComplains",components:{ComplainsList:A,ComplainForm:n["a"]},data(){return{tab:void 0===this.$store.getters.getUser.support_agent?"agent-complain":"assigned"}},mounted(){this.$root.$on("complain-created",(t=>{this.$q.notify({type:"positive",message:"Complain Created Successfully",position:"top-right"})}))},computed:{hasSupportAgentAccess:function(){return null!==this.$store.getters.getUser&&(void 0!==this.$store.getters.getUser.support_agent||void 0!==this.$store.getters.getUser.super_admin)},hasCallcenterAgentAccess:function(){return null!==this.$store.getters.getUser&&(void 0!==this.$store.getters.getUser.callcenter_agent||void 0!==this.$store.getters.getUser.super_admin)}},methods:{}},k=w,S=a("9989"),U=a("429b"),I=a("7460"),Q=a("eb85"),D=a("adad"),L=a("823b"),P=Object(m["a"])(k,s,i,!1,null,null,null);e["default"]=P.exports;$()(P,"components",{QPage:S["a"],QCard:g["a"],QTabs:U["a"],QTab:I["a"],QSeparator:Q["a"],QTabPanels:D["a"],QTabPanel:L["a"]})}}]);